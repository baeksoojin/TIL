# 실행

검증 과정을 거쳐 유효하다면 GraphQL 쿼리는 서버에서 실행되고 요청된 쿼리와 같은 형태의 결과를 반환한다.<br>

스칼라 값에 도달할 때까지 반복하면서 resolver에 의해서 각 필드가 실행이 된다.<br>
쿼리의 끝은 항상 스칼라 값이다!<br>

## 루트 필드와 resolvers

- `Root` type or `Query` type

최상위의 모든 진입지점을 나타낼 때의 타입을 root or query 타입이라고 한다.<br>
`resolver`는 함수의 인수를 받게 되고 4개의 인수를 받고 처리하도록 되어있다.<br>

Query 타입 이전의 객체, 쿼리의 필드에 제공된 모든 인수 그리고 문맥 정보를 보유하는 값 그리고 현재의 쿼리와 스키마 정보와 관련된 필드별 정보를 보유하는 info를 매개변수로 받는다.<br>

## 비동기 resolver

데이터베이스를 액세스하고 읽어오는 과정에서 데이터베이스 로딩작업은 **비동기 작업**이다.<br>
각 언어마다 비동기 값을 처리하는 방법이 존재하는데, 데이터베이스가 반환되면 새로운 객체가 생성되고 반환할 수 있도록 control할 수 있다.<br>

- resolver 함수가 비동기 처리를 인식하여 처리하게 되고 graphql은 task가 완료될 때까지 기다렸다가 효율적으로 동시에 처리하게 된다.<br>

## 기본 resolver

resolver를 생략하면 기본으로 이름 속성을 읽고 그것을 반환타입으로 가정하여 작성한다.<br>

## 스칼라 강제

특정 필드가 resolve 될 동안, 동시에 다른 필드가 resolve 될 수 있다.<br>
```
Human: {
  appearsIn(obj) {
    return obj.appearsIn // returns [ 4, 5, 6 ]
  }
}
```
이때 예를 들어서, appearsIn이 열거형임을 타입시스템이 알려주지만, 함수 자체만 봤을 때 숫자로 인식하여 숫자를 반환될 것이라고 예측할 수 있다.<br>
그러나, 타입 시스템은 어떤 값이 반환될지 알고있기에 resolver에 의해서 리턴된 값이 API 규약을 유지하도록 숫자가 아니라 Enum type의 값이 반환되는 것을 확인할 수 있다.<br>
 
이처럼 resolver가 타입 시스템의 반환 값을 미리알고 규약을 유지하도록 변경해주는 것을 **스칼라 강제**라고한다.

## 리스트 resolvers

- 속성을 가지는 객체 필드가 resolve가 된다면?

객체 필드는 id을 모두 로딩한 이후에 스키마에 정의된 필드값을 불러오는데, 이때 불러오는 작업은 id를 로드하고 한번에 동시에 아이템들을 로드하게된다.<br>

## 결과 생성하기

```
{
  human(id: 1002) {
    name
    appearsIn
    starships {
      name
    }
  }
}
```
다음과 같은 쿼리가 있었다면? name, appearsIn과 같은 필드의 이름은 `key`로 사용되고 resolve되어 꺼내져온 반환된 값이 `value`로 사용하여 `key`-`value` 맵에 들어가게 된다.<br>